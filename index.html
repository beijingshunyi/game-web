<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 添加内容安全策略 -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://api.telegram.org; 
             frame-src 'self' https://oauth.telegram.org; 
             script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com; 
             style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; 
             img-src 'self' data: https://picsum.photos; 
             font-src 'self' https://cdnjs.cloudflare.com; 
             connect-src 'self' https://wanhua-game.bingkuijing.workers.dev https://ylnfjlltesnlfanrxfoy.supabase.co;">
    <title>万花消消乐</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 0 15px;
            position: relative;
        }
        
        /* 登录页面 */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .login-box {
            background-color: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 100%;
            max-width: 400px;
        }
        
        .login-title {
            font-size: 28px;
            color: #764ba2;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .login-description {
            font-size: 16px;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .telegram-login-button {
            display: inline-block;
            background-color: #0088cc;
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 136, 204, 0.3);
        }
        
        .telegram-login-button:hover {
            background-color: #0077b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 136, 204, 0.4);
        }
        
        /* 主界面 */
        .main-container {
            display: none;
            padding-bottom: 80px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 0 0 20px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
            color: #764ba2;
            font-weight: bold;
        }
        
        .user-name {
            font-size: 16px;
            font-weight: bold;
        }
        
        .coins-display {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
        }
        
        .coins-icon {
            color: #ffd700;
            margin-right: 5px;
        }
        
        .coins-amount {
            font-weight: bold;
        }
        
        .menu-button {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        
        .map-container {
            margin-top: 20px;
            position: relative;
            min-height: 500px;
            background: url('https://picsum.photos/seed/gamemap/500/500.jpg') center/cover no-repeat;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .level-path {
            position: absolute;
            top: 50%;
            left: 10%;
            width: 80%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 5px;
            transform: translateY(-50%);
        }
        
        .level-node {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .level-node:hover {
            transform: translateY(-50%) scale(1.1);
        }
        
        .level-node.completed {
            background-color: #4CAF50;
            color: white;
        }
        
        .level-node.current {
            background-color: #FFC107;
            color: #333;
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.7);
        }
        
        .level-node.locked {
            background-color: #9E9E9E;
            color: white;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #666;
            text-decoration: none;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .nav-item.active {
            color: #764ba2;
        }
        
        .nav-item i {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        /* 游戏界面 */
        .game-container {
            display: none;
            padding-bottom: 80px;
        }
        
        .game-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .game-target, .game-moves, .game-score {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 15px;
            font-weight: bold;
        }
        
        .game-board-container {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            gap: 5px;
            background-color: rgba(0, 0, 0, 0.1);
            padding: 10px;
            border-radius: 10px;
        }
        
        .game-cell {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .game-cell:hover {
            transform: scale(1.05);
        }
        
        .game-cell.selected {
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
            transform: scale(1.1);
        }
        
        .game-cell.red {
            background-color: #FF5252;
        }
        
        .game-cell.blue {
            background-color: #448AFF;
        }
        
        .game-cell.green {
            background-color: #69F0AE;
        }
        
        .game-cell.yellow {
            background-color: #FFD740;
        }
        
        .game-cell.purple {
            background-color: #E040FB;
        }
        
        .game-cell.orange {
            background-color: #FFAB40;
        }
        
        .game-powerups {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .powerup-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .powerup-item:hover {
            transform: translateY(-5px);
        }
        
        .powerup-icon {
            width: 50px;
            height: 50px;
            background-color: #f0f0f0;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
            font-size: 20px;
            color: #764ba2;
        }
        
        .powerup-count {
            font-size: 12px;
            font-weight: bold;
            color: #666;
        }
        
        /* 任务界面 */
        .tasks-container {
            display: none;
            padding-bottom: 80px;
        }
        
        .tasks-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 0 0 20px 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .checkin-section {
            margin-top: 20px;
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .checkin-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #764ba2;
        }
        
        .checkin-button {
            display: block;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .checkin-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(118, 75, 162, 0.3);
        }
        
        .checkin-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .tasks-list {
            margin-top: 20px;
        }
        
        .task-item {
            background-color: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .task-info {
            flex-grow: 1;
        }
        
        .task-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .task-progress {
            font-size: 14px;
            color: #666;
        }
        
        .task-reward {
            display: flex;
            align-items: center;
            color: #FFC107;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .task-claim-button {
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .task-claim-button:hover {
            background-color: #45a049;
        }
        
        .task-claim-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        /* 成就界面 */
        .achievements-container {
            display: none;
            padding-bottom: 80px;
        }
        
        .achievements-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 0 0 20px 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .achievements-list {
            margin-top: 20px;
        }
        
        .achievement-item {
            background-color: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
        }
        
        .achievement-icon {
            width: 60px;
            height: 60px;
            background-color: #f0f0f0;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            font-size: 24px;
            color: #764ba2;
        }
        
        .achievement-icon.completed {
            background-color: #4CAF50;
            color: white;
        }
        
        .achievement-info {
            flex-grow: 1;
        }
        
        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .achievement-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .achievement-progress {
            font-size: 14px;
            color: #666;
        }
        
        .achievement-reward {
            display: flex;
            align-items: center;
            color: #FFC107;
            font-weight: bold;
            margin-left: 10px;
        }
        
        /* 提现界面 */
        .withdraw-container {
            display: none;
            padding-bottom: 80px;
        }
        
        .withdraw-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 0 0 20px 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .balance-card {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .balance-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            color: #764ba2;
            margin-bottom: 5px;
        }
        
        .balance-rmb {
            font-size: 18px;
            color: #666;
        }
        
        .withdraw-form {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.1);
        }
        
        .withdraw-button {
            display: block;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .withdraw-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(118, 75, 162, 0.3);
        }
        
        .withdraw-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .withdraw-history {
            margin-top: 20px;
        }
        
        .history-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #764ba2;
        }
        
        .history-item {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-info {
            flex-grow: 1;
        }
        
        .history-amount {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .history-date {
            font-size: 14px;
            color: #666;
        }
        
        .history-status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .history-status.pending {
            background-color: #FFF8E1;
            color: #FF8F00;
        }
        
        .history-status.approved {
            background-color: #E8F5E9;
            color: #2E7D32;
        }
        
        .history-status.rejected {
            background-color: #FFEBEE;
            color: #C62828;
        }
        
        .history-status.completed {
            background-color: #E8F5E9;
            color: #2E7D32;
        }
        
        /* 排行榜界面 */
        .leaderboard-container {
            display: none;
            padding-bottom: 80px;
        }
        
        .leaderboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 0 0 20px 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .leaderboard-tabs {
            display: flex;
            margin-top: 20px;
            background-color: white;
            border-radius: 15px;
            padding: 5px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .leaderboard-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .leaderboard-tab.active {
            background-color: #764ba2;
            color: white;
        }
        
        .leaderboard-list {
            margin-top: 20px;
        }
        
        .leaderboard-item {
            background-color: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
        }
        
        .leaderboard-rank {
            width: 40px;
            height: 40px;
            background-color: #f0f0f0;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .leaderboard-rank.top1 {
            background-color: #FFD700;
            color: white;
        }
        
        .leaderboard-rank.top2 {
            background-color: #C0C0C0;
            color: white;
        }
        
        .leaderboard-rank.top3 {
            background-color: #CD7F32;
            color: white;
        }
        
        .leaderboard-user {
            flex-grow: 1;
        }
        
        .leaderboard-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .leaderboard-coins {
            font-size: 14px;
            color: #666;
            display: flex;
            align-items: center;
        }
        
        .coins-icon-small {
            color: #FFC107;
            margin-right: 5px;
        }
        
        .leaderboard-award {
            padding: 5px 10px;
            background-color: #E8F5E9;
            color: #2E7D32;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .my-rank {
            background-color: #E1F5FE;
            border: 2px solid #29B6F6;
        }
        
        /* 页脚 */
        .footer {
            text-align: center;
            padding: 20px 0;
            color: #666;
            font-size: 14px;
            background-color: white;
            border-top: 1px solid #eee;
            margin-top: 20px;
        }
        
        .footer a {
            color: #764ba2;
            text-decoration: none;
            font-weight: bold;
        }
        
        /* 弹出框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #764ba2;
        }
        
        .modal-message {
            font-size: 16px;
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .modal-button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(118, 75, 162, 0.3);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 20px;
            color: #999;
            cursor: pointer;
        }
        
        /* 加载动画 */
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        .loader-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #764ba2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loader-text {
            margin-top: 15px;
            font-size: 16px;
            color: #666;
        }
        
        /* 响应式设计 */
        @media (max-width: 480px) {
            .game-board {
                grid-template-columns: repeat(8, 40px);
                grid-template-rows: repeat(8, 40px);
            }
            
            .game-cell {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- 登录页面 -->
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <div class="login-title">万花消消乐</div>
            <div class="login-description">
                欢迎来到万花消消乐！通过消除元素获得万花币，累积到一定数量即可提现！
            </div>
            <a href="https://t.me/bjxcwhljiluBot" class="telegram-login-button" target="_blank">
                <i class="fab fa-telegram-plane"></i> 使用Telegram登录
            </a>
        </div>
    </div>
    
    <!-- 主界面 -->
    <div class="container main-container" id="mainContainer">
        <div class="header">
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">U</div>
                <div class="user-name" id="userName">用户</div>
            </div>
            <div class="coins-display">
                <i class="fas fa-coins coins-icon"></i>
                <span class="coins-amount" id="coinsAmount">0</span>
            </div>
            <button class="menu-button" id="menuButton">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <div class="map-container" id="mapContainer">
            <div class="level-path"></div>
            <!-- 关卡节点将通过JS动态生成 -->
        </div>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item active" data-page="home">
                <i class="fas fa-home"></i>
                <span>首页</span>
            </a>
            <a href="#" class="nav-item" data-page="tasks">
                <i class="fas fa-tasks"></i>
                <span>任务</span>
            </a>
            <a href="#" class="nav-item" data-page="achievements">
                <i class="fas fa-trophy"></i>
                <span>成就</span>
            </a>
            <a href="#" class="nav-item" data-page="withdraw">
                <i class="fas fa-money-bill-wave"></i>
                <span>提现</span>
            </a>
            <a href="#" class="nav-item" data-page="leaderboard">
                <i class="fas fa-crown"></i>
                <span>排行榜</span>
            </a>
        </div>
        
        <div class="footer">
            本游戏由北京修车【万花楼】赞助；由 <a href="https://t.me/bjxc010" target="_blank">@bjxc010</a> 开发
        </div>
    </div>
    
    <!-- 游戏界面 -->
    <div class="container game-container" id="gameContainer">
        <div class="game-header">
            <div class="game-info">
                <div class="game-target">目标: <span id="gameTarget">1000</span></div>
                <div class="game-moves">步数: <span id="gameMoves">20</span></div>
                <div class="game-score">分数: <span id="gameScore">0</span></div>
            </div>
        </div>
        
        <div class="game-board-container">
            <div class="game-board" id="gameBoard">
                <!-- 游戏格子将通过JS动态生成 -->
            </div>
        </div>
        
        <div class="game-powerups">
            <div class="powerup-item" data-powerup="refresh">
                <div class="powerup-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div class="powerup-count" id="refreshCount">3</div>
            </div>
            <div class="powerup-item" data-powerup="bomb">
                <div class="powerup-icon">
                    <i class="fas fa-bomb"></i>
                </div>
                <div class="powerup-count" id="bombCount">3</div>
            </div>
            <div class="powerup-item" data-powerup="rocket">
                <div class="powerup-icon">
                    <i class="fas fa-rocket"></i>
                </div>
                <div class="powerup-count" id="rocketCount">3</div>
            </div>
            <div class="powerup-item" data-powerup="rainbow">
                <div class="powerup-icon">
                    <i class="fas fa-rainbow"></i>
                </div>
                <div class="powerup-count" id="rainbowCount">1</div>
            </div>
        </div>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item" id="backToMain">
                <i class="fas fa-arrow-left"></i>
                <span>返回</span>
            </a>
        </div>
        
        <div class="footer">
            本游戏由北京修车【万花楼】赞助；由 <a href="https://t.me/bjxc010" target="_blank">@bjxc010</a> 开发
        </div>
    </div>
    
    <!-- 任务界面 -->
    <div class="container tasks-container" id="tasksContainer">
        <div class="tasks-header">每日任务</div>
        
        <div class="checkin-section">
            <div class="checkin-title">每日签到</div>
            <button class="checkin-button" id="checkinButton">签到</button>
        </div>
        
        <div class="tasks-list" id="tasksList">
            <!-- 任务列表将通过JS动态生成 -->
        </div>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                <span>首页</span>
            </a>
            <a href="#" class="nav-item active" data-page="tasks">
                <i class="fas fa-tasks"></i>
                <span>任务</span>
            </a>
            <a href="#" class="nav-item" data-page="achievements">
                <i class="fas fa-trophy"></i>
                <span>成就</span>
            </a>
            <a href="#" class="nav-item" data-page="withdraw">
                <i class="fas fa-money-bill-wave"></i>
                <span>提现</span>
            </a>
            <a href="#" class="nav-item" data-page="leaderboard">
                <i class="fas fa-crown"></i>
                <span>排行榜</span>
            </a>
        </div>
        
        <div class="footer">
            本游戏由北京修车【万花楼】赞助；由 <a href="https://t.me/bjxc010" target="_blank">@bjxc010</a> 开发
        </div>
    </div>
    
    <!-- 成就界面 -->
    <div class="container achievements-container" id="achievementsContainer">
        <div class="achievements-header">成就</div>
        
        <div class="achievements-list" id="achievementsList">
            <!-- 成就列表将通过JS动态生成 -->
        </div>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                <span>首页</span>
            </a>
            <a href="#" class="nav-item" data-page="tasks">
                <i class="fas fa-tasks"></i>
                <span>任务</span>
            </a>
            <a href="#" class="nav-item active" data-page="achievements">
                <i class="fas fa-trophy"></i>
                <span>成就</span>
            </a>
            <a href="#" class="nav-item" data-page="withdraw">
                <i class="fas fa-money-bill-wave"></i>
                <span>提现</span>
            </a>
            <a href="#" class="nav-item" data-page="leaderboard">
                <i class="fas fa-crown"></i>
                <span>排行榜</span>
            </a>
        </div>
        
        <div class="footer">
            本游戏由北京修车【万花楼】赞助；由 <a href="https://t.me/bjxc010" target="_blank">@bjxc010</a> 开发
        </div>
    </div>
    
    <!-- 提现界面 -->
    <div class="container withdraw-container" id="withdrawContainer">
        <div class="withdraw-header">提现</div>
        
        <div class="balance-card">
            <div class="balance-title">当前余额</div>
            <div class="balance-amount" id="balanceAmount">0</div>
            <div class="balance-rmb" id="balanceRmb">约 0.00 元</div>
        </div>
        
        <div class="withdraw-form">
            <div class="form-group">
                <label class="form-label" for="alipayAccount">支付宝账号</label>
                <input type="text" class="form-input" id="alipayAccount" placeholder="请输入支付宝账号">
            </div>
            <div class="form-group">
                <label class="form-label" for="realName">真实姓名</label>
                <input type="text" class="form-input" id="realName" placeholder="请输入真实姓名">
            </div>
            <div class="form-group">
                <label class="form-label" for="withdrawAmount">提现金额 (万花币)</label>
                <input type="number" class="form-input" id="withdrawAmount" placeholder="最低提现1000万花币" min="10000000">
            </div>
            <button class="withdraw-button" id="withdrawButton">提交提现申请</button>
        </div>
        
        <div class="withdraw-history">
            <div class="history-title">提现记录</div>
            <div id="withdrawHistory">
                <!-- 提现记录将通过JS动态生成 -->
            </div>
        </div>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                <span>首页</span>
            </a>
            <a href="#" class="nav-item" data-page="tasks">
                <i class="fas fa-tasks"></i>
                <span>任务</span>
            </a>
            <a href="#" class="nav-item" data-page="achievements">
                <i class="fas fa-trophy"></i>
                <span>成就</span>
            </a>
            <a href="#" class="nav-item active" data-page="withdraw">
                <i class="fas fa-money-bill-wave"></i>
                <span>提现</span>
            </a>
            <a href="#" class="nav-item" data-page="leaderboard">
                <i class="fas fa-crown"></i>
                <span>排行榜</span>
            </a>
        </div>
        
        <div class="footer">
            本游戏由北京修车【万花楼】赞助；由 <a href="https://t.me/bjxc010" target="_blank">@bjxc010</a> 开发
        </div>
    </div>
    
    <!-- 排行榜界面 -->
    <div class="container leaderboard-container" id="leaderboardContainer">
        <div class="leaderboard-header">排行榜</div>
        
        <div class="leaderboard-tabs">
            <div class="leaderboard-tab active" data-tab="monthly">月榜</div>
            <div class="leaderboard-tab" data-tab="alltime">总榜</div>
        </div>
        
        <div class="leaderboard-list" id="leaderboardList">
            <!-- 排行榜列表将通过JS动态生成 -->
        </div>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                <span>首页</span>
            </a>
            <a href="#" class="nav-item" data-page="tasks">
                <i class="fas fa-tasks"></i>
                <span>任务</span>
            </a>
            <a href="#" class="nav-item" data-page="achievements">
                <i class="fas fa-trophy"></i>
                <span>成就</span>
            </a>
            <a href="#" class="nav-item" data-page="withdraw">
                <i class="fas fa-money-bill-wave"></i>
                <span>提现</span>
            </a>
            <a href="#" class="nav-item active" data-page="leaderboard">
                <i class="fas fa-crown"></i>
                <span>排行榜</span>
            </a>
        </div>
        
        <div class="footer">
            本游戏由北京修车【万花楼】赞助；由 <a href="https://t.me/bjxc010" target="_blank">@bjxc010</a> 开发
        </div>
    </div>
    
    <!-- 弹出框 -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-title" id="modalTitle">提示</div>
            <div class="modal-message" id="modalMessage">消息内容</div>
            <button class="modal-button" id="modalButton">确定</button>
        </div>
    </div>
    
    <!-- 加载动画 -->
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">加载中...</div>
    </div>
    
    <script>
        // API 基础URL
        const API_BASE_URL = 'https://wanhua-game.bingkuijing.workers.dev';
        
        // 全局变量
        let currentUser = null;
        let authToken = null;
        let currentLevel = null;
        let gameBoard = [];
        let selectedCell = null;
        let gameScore = 0;
        let gameMoves = 0;
        let gameTarget = 0;
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 检查URL参数中是否有user_id
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('user_id');
            
            if (userId) {
                // 使用提供的user_id登录
                loginWithUserId(userId);
            } else {
                // 显示登录页面
                showLoginPage();
            }
            
            // 绑定导航事件
            bindNavigationEvents();
            
            // 绑定游戏事件
            bindGameEvents();
            
            // 绑定任务事件
            bindTaskEvents();
            
            // 绑定提现事件
            bindWithdrawEvents();
            
            // 绑定排行榜事件
            bindLeaderboardEvents();
            
            // 绑定模态框事件
            bindModalEvents();
        });
        
        // 显示登录页面
        function showLoginPage() {
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('tasksContainer').style.display = 'none';
            document.getElementById('achievementsContainer').style.display = 'none';
            document.getElementById('withdrawContainer').style.display = 'none';
            document.getElementById('leaderboardContainer').style.display = 'none';
        }
        
        // 使用user_id登录
        function loginWithUserId(userId) {
            showLoader();
            
            // 设置认证token
            authToken = userId;
            
            // 获取用户信息
            fetch(`${API_BASE_URL}/api/user`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('登录失败', data.error);
                    showLoginPage();
                    return;
                }
                
                currentUser = data;
                
                // 显示主界面
                showMainPage();
                
                // 更新用户信息
                updateUserInfo();
                
                // 加载关卡地图
                loadLevelMap();
            })
            .catch(error => {
                hideLoader();
                showModal('登录失败', '网络错误，请稍后再试。');
                showLoginPage();
                console.error('Login error:', error);
            });
        }
        
        // 显示主页面
        function showMainPage() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'block';
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('tasksContainer').style.display = 'none';
            document.getElementById('achievementsContainer').style.display = 'none';
            document.getElementById('withdrawContainer').style.display = 'none';
            document.getElementById('leaderboardContainer').style.display = 'none';
            
            // 更新导航状态
            updateNavigationState('home');
        }
        
        // 更新用户信息
        function updateUserInfo() {
            if (!currentUser) return;
            
            // 更新头像
            const userAvatar = document.getElementById('userAvatar');
            userAvatar.textContent = currentUser.first_name ? currentUser.first_name.charAt(0).toUpperCase() : 'U';
            
            // 更新用户名
            const userName = document.getElementById('userName');
            userName.textContent = currentUser.first_name || '用户';
            
            // 更新万花币
            const coinsAmount = document.getElementById('coinsAmount');
            coinsAmount.textContent = currentUser.flower_coins.toLocaleString();
        }
        
        // 加载关卡地图
        function loadLevelMap() {
            const mapContainer = document.getElementById('mapContainer');
            
            // 清除现有关卡节点
            const existingNodes = mapContainer.querySelectorAll('.level-node');
            existingNodes.forEach(node => node.remove());
            
            // 获取关卡列表
            fetch(`${API_BASE_URL}/api/levels`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    showModal('加载失败', data.error);
                    return;
                }
                
                // 创建关卡节点
                const levels = data;
                const mapWidth = mapContainer.offsetWidth;
                const nodeSpacing = mapWidth * 0.8 / (levels.length - 1);
                
                levels.forEach((level, index) => {
                    const node = document.createElement('div');
                    node.className = 'level-node';
                    node.textContent = level.level_number;
                    node.dataset.levelId = level.id;
                    
                    // 设置位置
                    const leftPercent = 10 + (index / (levels.length - 1)) * 80;
                    node.style.left = `${leftPercent}%`;
                    
                    // 设置状态
                    if (index === 0) {
                        node.classList.add('current');
                    } else if (index > 2) {
                        node.classList.add('locked');
                    } else {
                        node.classList.add('completed');
                    }
                    
                    // 添加点击事件
                    node.addEventListener('click', function() {
                        if (node.classList.contains('locked')) {
                            showModal('关卡锁定', '请先完成前面的关卡。');
                            return;
                        }
                        
                        startGame(level.id);
                    });
                    
                    mapContainer.appendChild(node);
                });
            })
            .catch(error => {
                showModal('加载失败', '网络错误，请稍后再试。');
                console.error('Load levels error:', error);
            });
        }
        
        // 开始游戏
        function startGame(levelId) {
            showLoader();
            
            // 获取关卡信息
            fetch(`${API_BASE_URL}/api/level?id=${levelId}`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('加载失败', data.error);
                    return;
                }
                
                currentLevel = data;
                
                // 初始化游戏
                initGame();
                
                // 显示游戏界面
                showGamePage();
            })
            .catch(error => {
                hideLoader();
                showModal('加载失败', '网络错误，请稍后再试。');
                console.error('Load level error:', error);
            });
        }
        
        // 显示游戏页面
        function showGamePage() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            document.getElementById('tasksContainer').style.display = 'none';
            document.getElementById('achievementsContainer').style.display = 'none';
            document.getElementById('withdrawContainer').style.display = 'none';
            document.getElementById('leaderboardContainer').style.display = 'none';
        }
        
        // 初始化游戏
        function initGame() {
            // 重置游戏状态
            gameScore = 0;
            gameMoves = currentLevel.max_moves;
            gameTarget = currentLevel.target_score;
            gameBoard = [];
            selectedCell = null;
            
            // 更新游戏UI
            document.getElementById('gameTarget').textContent = gameTarget.toLocaleString();
            document.getElementById('gameMoves').textContent = gameMoves;
            document.getElementById('gameScore').textContent = gameScore.toLocaleString();
            
            // 创建游戏棋盘
            createGameBoard();
        }
        
        // 创建游戏棋盘
        function createGameBoard() {
            const boardElement = document.getElementById('gameBoard');
            boardElement.innerHTML = '';
            
            const boardSize = currentLevel.board_layout.size;
            const rows = boardSize[1];
            const cols = boardSize[0];
            
            // 初始化游戏棋盘数组
            for (let i = 0; i < rows; i++) {
                gameBoard[i] = [];
                for (let j = 0; j < cols; j++) {
                    gameBoard[i][j] = getRandomGem();
                }
            }
            
            // 确保初始棋盘没有匹配
            while (hasMatches()) {
                shuffleBoard();
            }
            
            // 创建棋盘UI
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const cell = document.createElement('div');
                    cell.className = `game-cell ${gameBoard[i][j]}`;
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    
                    // 添加点击事件
                    cell.addEventListener('click', handleCellClick);
                    
                    boardElement.appendChild(cell);
                }
            }
        }
        
        // 获取随机宝石
        function getRandomGem() {
            const gems = ['red', 'blue', 'green', 'yellow', 'purple', 'orange'];
            return gems[Math.floor(Math.random() * gems.length)];
        }
        
        // 检查是否有匹配
        function hasMatches() {
            const rows = gameBoard.length;
            const cols = gameBoard[0].length;
            
            // 检查水平匹配
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols - 2; j++) {
                    if (gameBoard[i][j] === gameBoard[i][j + 1] && 
                        gameBoard[i][j] === gameBoard[i][j + 2]) {
                        return true;
                    }
                }
            }
            
            // 检查垂直匹配
            for (let i = 0; i < rows - 2; i++) {
                for (let j = 0; j < cols; j++) {
                    if (gameBoard[i][j] === gameBoard[i + 1][j] && 
                        gameBoard[i][j] === gameBoard[i + 2][j]) {
                        return true;
                    }
                }
            }
            
            return false;
        }
        
        // 打乱棋盘
        function shuffleBoard() {
            const rows = gameBoard.length;
            const cols = gameBoard[0].length;
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    gameBoard[i][j] = getRandomGem();
                }
            }
        }
        
        // 处理格子点击
        function handleCellClick(event) {
            const cell = event.target;
            const row = parseInt(cell.dataset.row);
            const col = parseInt(cell.dataset.col);
            
            if (selectedCell) {
                // 如果已经选中了一个格子
                const selectedRow = parseInt(selectedCell.dataset.row);
                const selectedCol = parseInt(selectedCell.dataset.col);
                
                // 检查是否相邻
                if ((Math.abs(row - selectedRow) === 1 && col === selectedCol) ||
                    (Math.abs(col - selectedCol) === 1 && row === selectedRow)) {
                    // 交换格子
                    swapCells(selectedRow, selectedCol, row, col);
                } else {
                    // 选择新格子
                    selectedCell.classList.remove('selected');
                    selectedCell = cell;
                    cell.classList.add('selected');
                }
            } else {
                // 选择第一个格子
                selectedCell = cell;
                cell.classList.add('selected');
            }
        }
        
        // 交换格子
        function swapCells(row1, col1, row2, col2) {
            // 交换数据
            const temp = gameBoard[row1][col1];
            gameBoard[row1][col1] = gameBoard[row2][col2];
            gameBoard[row2][col2] = temp;
            
            // 更新UI
            updateBoardUI();
            
            // 检查是否有匹配
            if (hasMatchesAt(row1, col1) || hasMatchesAt(row2, col2)) {
                // 有匹配，处理匹配
                processMatches();
                
                // 减少步数
                gameMoves--;
                document.getElementById('gameMoves').textContent = gameMoves;
                
                // 检查游戏是否结束
                if (gameMoves <= 0) {
                    endGame();
                }
            } else {
                // 没有匹配，交换回来
                setTimeout(() => {
                    const temp = gameBoard[row1][col1];
                    gameBoard[row1][col1] = gameBoard[row2][col2];
                    gameBoard[row2][col2] = temp;
                    updateBoardUI();
                }, 300);
            }
            
            // 清除选中状态
            if (selectedCell) {
                selectedCell.classList.remove('selected');
                selectedCell = null;
            }
        }
        
        // 检查指定位置是否有匹配
        function hasMatchesAt(row, col) {
            const gem = gameBoard[row][col];
            const rows = gameBoard.length;
            const cols = gameBoard[0].length;
            
            // 检查水平匹配
            let horizontalCount = 1;
            
            // 向左检查
            for (let j = col - 1; j >= 0 && gameBoard[row][j] === gem; j--) {
                horizontalCount++;
            }
            
            // 向右检查
            for (let j = col + 1; j < cols && gameBoard[row][j] === gem; j++) {
                horizontalCount++;
            }
            
            if (horizontalCount >= 3) return true;
            
            // 检查垂直匹配
            let verticalCount = 1;
            
            // 向上检查
            for (let i = row - 1; i >= 0 && gameBoard[i][col] === gem; i--) {
                verticalCount++;
            }
            
            // 向下检查
            for (let i = row + 1; i < rows && gameBoard[i][col] === gem; i++) {
                verticalCount++;
            }
            
            if (verticalCount >= 3) return true;
            
            return false;
        }
        
        // 处理匹配
        function processMatches() {
            const rows = gameBoard.length;
            const cols = gameBoard[0].length;
            const matchedCells = [];
            
            // 查找所有匹配
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (gameBoard[i][j] !== null && hasMatchesAt(i, j)) {
                        matchedCells.push({row: i, col: j});
                    }
                }
            }
            
            if (matchedCells.length === 0) return;
            
            // 移除匹配的格子
            matchedCells.forEach(cell => {
                gameBoard[cell.row][cell.col] = null;
            });
            
            // 更新分数
            gameScore += matchedCells.length * 10;
            document.getElementById('gameScore').textContent = gameScore.toLocaleString();
            
            // 更新UI
            updateBoardUI();
            
            // 处理下落
            setTimeout(() => {
                dropGems();
                
                // 填充新格子
                setTimeout(() => {
                    fillBoard();
                    
                    // 检查新的匹配
                    setTimeout(() => {
                        processMatches();
                    }, 300);
                }, 300);
            }, 300);
        }
        
        // 更新棋盘UI
        function updateBoardUI() {
            const cells = document.querySelectorAll('.game-cell');
            
            cells.forEach(cell => {
                const row = parseInt(cell.dataset.row);
                const col = parseInt(cell.dataset.col);
                const gem = gameBoard[row][col];
                
                // 清除所有类
                cell.className = 'game-cell';
                
                if (gem) {
                    cell.classList.add(gem);
                }
            });
        }
        
        // 处理宝石下落
        function dropGems() {
            const rows = gameBoard.length;
            const cols = gameBoard[0].length;
            
            // 从下往上处理每一列
            for (let j = 0; j < cols; j++) {
                // 记录该列中空格的位置
                const emptySpaces = [];
                
                for (let i = rows - 1; i >= 0; i--) {
                    if (gameBoard[i][j] === null) {
                        emptySpaces.push(i);
                    } else if (emptySpaces.length > 0) {
                        // 将宝石下移到最下面的空格
                        const targetRow = emptySpaces.shift();
                        gameBoard[targetRow][j] = gameBoard[i][j];
                        gameBoard[i][j] = null;
                        emptySpaces.push(i);
                    }
                }
            }
            
            // 更新UI
            updateBoardUI();
        }
        
        // 填充棋盘
        function fillBoard() {
            const rows = gameBoard.length;
            const cols = gameBoard[0].length;
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (gameBoard[i][j] === null) {
                        gameBoard[i][j] = getRandomGem();
                    }
                }
            }
            
            // 更新UI
            updateBoardUI();
        }
        
        // 结束游戏
        function endGame() {
            // 计算星级
            let stars = 0;
            if (gameScore >= gameTarget) {
                stars = 1;
                if (gameScore >= gameTarget * 1.5) {
                    stars = 2;
                    if (gameScore >= gameTarget * 2) {
                        stars = 3;
                    }
                }
            }
            
            // 发送游戏结果到服务器
            fetch(`${API_BASE_URL}/api/game/complete`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    levelId: currentLevel.id,
                    score: gameScore,
                    movesUsed: currentLevel.max_moves - gameMoves,
                    stars: stars,
                    gameData: {}
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    showModal('提交失败', data.error);
                    return;
                }
                
                // 更新用户信息
                currentUser.flower_coins = data.new_balance;
                updateUserInfo();
                
                // 显示结果
                let message = `游戏结束！\n\n得分：${gameScore.toLocaleString()}\n星级：${'★'.repeat(stars)}${'☆'.repeat(3 - stars)}\n\n获得万花币：${data.flower_coins_earned.toLocaleString()}`;
                
                if (stars > 0) {
                    message += '\n\n恭喜通关！';
                } else {
                    message += '\n\n很遗憾，未达到目标分数，请再试一次！';
                }
                
                showModal('游戏结果', message, () => {
                    // 返回主界面
                    showMainPage();
                    
                    // 重新加载关卡地图
                    loadLevelMap();
                });
            })
            .catch(error => {
                showModal('提交失败', '网络错误，请稍后再试。');
                console.error('Complete game error:', error);
            });
        }
        
        // 绑定导航事件
        function bindNavigationEvents() {
            // 底部导航
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const page = this.dataset.page;
                    if (!page) return;
                    
                    // 更新导航状态
                    updateNavigationState(page);
                    
                    // 切换页面
                    switch (page) {
                        case 'home':
                            showMainPage();
                            break;
                        case 'tasks':
                            showTasksPage();
                            break;
                        case 'achievements':
                            showAchievementsPage();
                            break;
                        case 'withdraw':
                            showWithdrawPage();
                            break;
                        case 'leaderboard':
                            showLeaderboardPage();
                            break;
                    }
                });
            });
            
            // 返回按钮
            document.getElementById('backToMain').addEventListener('click', function(e) {
                e.preventDefault();
                showMainPage();
            });
        }
        
        // 更新导航状态
        function updateNavigationState(activePage) {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.dataset.page === activePage) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        
        // 显示任务页面
        function showTasksPage() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('tasksContainer').style.display = 'block';
            document.getElementById('achievementsContainer').style.display = 'none';
            document.getElementById('withdrawContainer').style.display = 'none';
            document.getElementById('leaderboardContainer').style.display = 'none';
            
            // 加载任务列表
            loadTasks();
            
            // 检查签到状态
            checkCheckinStatus();
        }
        
        // 加载任务列表
        function loadTasks() {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/tasks`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('加载失败', data.error);
                    return;
                }
                
                // 更新任务列表UI
                const tasksList = document.getElementById('tasksList');
                tasksList.innerHTML = '';
                
                data.forEach((task, index) => {
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-item';
                    
                    const taskInfo = document.createElement('div');
                    taskInfo.className = 'task-info';
                    
                    const taskTitle = document.createElement('div');
                    taskTitle.className = 'task-title';
                    taskTitle.textContent = task.daily_tasks.description;
                    
                    const taskProgress = document.createElement('div');
                    taskProgress.className = 'task-progress';
                    taskProgress.textContent = `进度: ${task.progress}/${task.daily_tasks.target_value}`;
                    
                    taskInfo.appendChild(taskTitle);
                    taskInfo.appendChild(taskProgress);
                    
                    const taskReward = document.createElement('div');
                    taskReward.className = 'task-reward';
                    taskReward.innerHTML = `<i class="fas fa-coins coins-icon"></i> ${task.daily_tasks.flower_coins_reward}`;
                    
                    const claimButton = document.createElement('button');
                    claimButton.className = 'task-claim-button';
                    claimButton.textContent = '领取';
                    claimButton.dataset.taskId = task.id;
                    
                    if (!task.is_completed) {
                        claimButton.textContent = '未完成';
                        claimButton.disabled = true;
                    } else if (task.flower_coins_claimed) {
                        claimButton.textContent = '已领取';
                        claimButton.disabled = true;
                    }
                    
                    claimButton.addEventListener('click', function() {
                        claimTaskReward(task.id);
                    });
                    
                    taskItem.appendChild(taskInfo);
                    taskItem.appendChild(taskReward);
                    taskItem.appendChild(claimButton);
                    
                    tasksList.appendChild(taskItem);
                });
            })
            .catch(error => {
                hideLoader();
                showModal('加载失败', '网络错误，请稍后再试。');
                console.error('Load tasks error:', error);
            });
        }
        
        // 检查签到状态
        function checkCheckinStatus() {
            const today = new Date().toISOString().split('T')[0];
            
            // 这里简化处理，实际应用中应该从服务器获取签到状态
            // 假设今天还没有签到
            document.getElementById('checkinButton').disabled = false;
            document.getElementById('checkinButton').textContent = '签到';
        }
        
        // 绑定任务事件
        function bindTaskEvents() {
            // 签到按钮
            document.getElementById('checkinButton').addEventListener('click', function() {
                if (this.disabled) return;
                
                showLoader();
                
                fetch(`${API_BASE_URL}/api/checkin`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    hideLoader();
                    
                    if (data.error) {
                        showModal('签到失败', data.error);
                        return;
                    }
                    
                    // 更新用户信息
                    currentUser.flower_coins = data.new_balance;
                    updateUserInfo();
                    
                    // 更新签到按钮状态
                    document.getElementById('checkinButton').disabled = true;
                    document.getElementById('checkinButton').textContent = '已签到';
                    
                    // 显示签到结果
                    showModal('签到成功', `连续签到：${data.consecutive_days} 天\n获得奖励：${data.flower_coins_earned.toLocaleString()} 万花币`);
                })
                .catch(error => {
                    hideLoader();
                    showModal('签到失败', '网络错误，请稍后再试。');
                    console.error('Checkin error:', error);
                });
            });
        }
        
        // 领取任务奖励
        function claimTaskReward(taskId) {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/tasks/claim`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    taskId: taskId
                })
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('领取失败', data.error);
                    return;
                }
                
                // 更新用户信息
                currentUser.flower_coins = data.new_balance;
                updateUserInfo();
                
                // 重新加载任务列表
                loadTasks();
                
                // 显示领取结果
                showModal('领取成功', `获得 ${data.flower_coins_earned.toLocaleString()} 万花币`);
            })
            .catch(error => {
                hideLoader();
                showModal('领取失败', '网络错误，请稍后再试。');
                console.error('Claim task reward error:', error);
            });
        }
        
        // 显示成就页面
        function showAchievementsPage() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('tasksContainer').style.display = 'none';
            document.getElementById('achievementsContainer').style.display = 'block';
            document.getElementById('withdrawContainer').style.display = 'none';
            document.getElementById('leaderboardContainer').style.display = 'none';
            
            // 加载成就列表
            loadAchievements();
        }
        
        // 加载成就列表
        function loadAchievements() {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/achievements`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('加载失败', data.error);
                    return;
                }
                
                // 更新成就列表UI
                const achievementsList = document.getElementById('achievementsList');
                achievementsList.innerHTML = '';
                
                data.forEach(achievement => {
                    const achievementItem = document.createElement('div');
                    achievementItem.className = 'achievement-item';
                    
                    const achievementIcon = document.createElement('div');
                    achievementIcon.className = 'achievement-icon';
                    if (achievement.is_completed) {
                        achievementIcon.classList.add('completed');
                    }
                    achievementIcon.innerHTML = `<i class="fas fa-trophy"></i>`;
                    
                    const achievementInfo = document.createElement('div');
                    achievementInfo.className = 'achievement-info';
                    
                    const achievementTitle = document.createElement('div');
                    achievementTitle.className = 'achievement-title';
                    achievementTitle.textContent = achievement.achievements.name;
                    
                    const achievementDescription = document.createElement('div');
                    achievementDescription.className = 'achievement-description';
                    achievementDescription.textContent = achievement.achievements.description;
                    
                    const achievementProgress = document.createElement('div');
                    achievementProgress.className = 'achievement-progress';
                    achievementProgress.textContent = `进度: ${achievement.progress}/${achievement.achievements.target_value}`;
                    
                    achievementInfo.appendChild(achievementTitle);
                    achievementInfo.appendChild(achievementDescription);
                    achievementInfo.appendChild(achievementProgress);
                    
                    const achievementReward = document.createElement('div');
                    achievementReward.className = 'achievement-reward';
                    achievementReward.innerHTML = `<i class="fas fa-coins coins-icon"></i> ${achievement.achievements.flower_coins_reward}`;
                    
                    const claimButton = document.createElement('button');
                    claimButton.className = 'task-claim-button';
                    claimButton.textContent = '领取';
                    claimButton.dataset.achievementId = achievement.id;
                    
                    if (!achievement.is_completed) {
                        claimButton.textContent = '未完成';
                        claimButton.disabled = true;
                    } else if (achievement.flower_coins_claimed) {
                        claimButton.textContent = '已领取';
                        claimButton.disabled = true;
                    }
                    
                    claimButton.addEventListener('click', function() {
                        claimAchievementReward(achievement.id);
                    });
                    
                    achievementItem.appendChild(achievementIcon);
                    achievementItem.appendChild(achievementInfo);
                    achievementItem.appendChild(achievementReward);
                    achievementItem.appendChild(claimButton);
                    
                    achievementsList.appendChild(achievementItem);
                });
            })
            .catch(error => {
                hideLoader();
                showModal('加载失败', '网络错误，请稍后再试。');
                console.error('Load achievements error:', error);
            });
        }
        
        // 领取成就奖励
        function claimAchievementReward(achievementId) {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/achievements/claim`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    achievementId: achievementId
                })
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('领取失败', data.error);
                    return;
                }
                
                // 更新用户信息
                currentUser.flower_coins = data.new_balance;
                updateUserInfo();
                
                // 重新加载成就列表
                loadAchievements();
                
                // 显示领取结果
                showModal('领取成功', `获得 ${data.flower_coins_earned.toLocaleString()} 万花币`);
            })
            .catch(error => {
                hideLoader();
                showModal('领取失败', '网络错误，请稍后再试。');
                console.error('Claim achievement reward error:', error);
            });
        }
        
        // 显示提现页面
        function showWithdrawPage() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('tasksContainer').style.display = 'none';
            document.getElementById('achievementsContainer').style.display = 'none';
            document.getElementById('withdrawContainer').style.display = 'block';
            document.getElementById('leaderboardContainer').style.display = 'none';
            
            // 更新余额显示
            updateBalanceDisplay();
            
            // 加载提现记录
            loadWithdrawHistory();
        }
        
        // 更新余额显示
        function updateBalanceDisplay() {
            document.getElementById('balanceAmount').textContent = currentUser.flower_coins.toLocaleString();
            document.getElementById('balanceRmb').textContent = `约 ${(currentUser.flower_coins / 1000000).toFixed(2)} 元`;
        }
        
        // 加载提现记录
        function loadWithdrawHistory() {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/withdrawals`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('加载失败', data.error);
                    return;
                }
                
                // 更新提现记录UI
                const withdrawHistory = document.getElementById('withdrawHistory');
                withdrawHistory.innerHTML = '';
                
                if (data.length === 0) {
                    withdrawHistory.innerHTML = '<div style="text-align: center; color: #999; padding: 20px;">暂无提现记录</div>';
                    return;
                }
                
                data.forEach(withdrawal => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    
                    const historyInfo = document.createElement('div');
                    historyInfo.className = 'history-info';
                    
                    const historyAmount = document.createElement('div');
                    historyAmount.className = 'history-amount';
                    historyAmount.textContent = `${withdrawal.amount_flower_coins.toLocaleString()} 万花币`;
                    
                    const historyDate = document.createElement('div');
                    historyDate.className = 'history-date';
                    historyDate.textContent = new Date(withdrawal.created_at).toLocaleString();
                    
                    historyInfo.appendChild(historyAmount);
                    historyInfo.appendChild(historyDate);
                    
                    const historyStatus = document.createElement('div');
                    historyStatus.className = `history-status ${withdrawal.status}`;
                    
                    switch (withdrawal.status) {
                        case 'pending':
                            historyStatus.textContent = '处理中';
                            break;
                        case 'approved':
                            historyStatus.textContent = '已批准';
                            break;
                        case 'rejected':
                            historyStatus.textContent = '已拒绝';
                            break;
                        case 'completed':
                            historyStatus.textContent = '已完成';
                            break;
                    }
                    
                    historyItem.appendChild(historyInfo);
                    historyItem.appendChild(historyStatus);
                    
                    withdrawHistory.appendChild(historyItem);
                });
            })
            .catch(error => {
                hideLoader();
                showModal('加载失败', '网络错误，请稍后再试。');
                console.error('Load withdraw history error:', error);
            });
        }
        
        // 绑定提现事件
        function bindWithdrawEvents() {
            // 提现按钮
            document.getElementById('withdrawButton').addEventListener('click', function() {
                const alipayAccount = document.getElementById('alipayAccount').value.trim();
                const realName = document.getElementById('realName').value.trim();
                const amount = parseInt(document.getElementById('withdrawAmount').value);
                
                // 验证输入
                if (!alipayAccount) {
                    showModal('输入错误', '请输入支付宝账号');
                    return;
                }
                
                if (!realName) {
                    showModal('输入错误', '请输入真实姓名');
                    return;
                }
                
                if (!amount || amount < 10000000) {
                    showModal('输入错误', '最低提现金额为1000万花币');
                    return;
                }
                
                if (amount > currentUser.flower_coins) {
                    showModal('余额不足', '您的万花币余额不足');
                    return;
                }
                
                // 确认提现
                showModal('确认提现', `您将提现 ${amount.toLocaleString()} 万花币（约 ${(amount / 1000000).toFixed(2)} 元）到支付宝账号 ${alipayAccount}，确认吗？`, function() {
                    processWithdrawal(alipayAccount, realName, amount);
                }, true);
            });
        }
        
        // 处理提现
        function processWithdrawal(alipayAccount, realName, amount) {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/withdraw`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    alipayAccount: alipayAccount,
                    realName: realName,
                    amount: amount
                })
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('提现失败', data.error);
                    return;
                }
                
                // 更新用户信息
                currentUser.flower_coins = data.new_balance;
                updateUserInfo();
                updateBalanceDisplay();
                
                // 清空表单
                document.getElementById('alipayAccount').value = '';
                document.getElementById('realName').value = '';
                document.getElementById('withdrawAmount').value = '';
                
                // 重新加载提现记录
                loadWithdrawHistory();
                
                // 显示提现结果
                showModal('提现成功', `您的提现申请已提交，我们将在24小时内处理！\n\n提现金额：${data.amount_flower_coins.toLocaleString()} 万花币（约 ${data.amount_rmb} 元）`);
            })
            .catch(error => {
                hideLoader();
                showModal('提现失败', '网络错误，请稍后再试。');
                console.error('Withdraw error:', error);
            });
        }
        
        // 显示排行榜页面
        function showLeaderboardPage() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('tasksContainer').style.display = 'none';
            document.getElementById('achievementsContainer').style.display = 'none';
            document.getElementById('withdrawContainer').style.display = 'none';
            document.getElementById('leaderboardContainer').style.display = 'block';
            
            // 加载排行榜
            loadLeaderboard('monthly');
        }
        
        // 加载排行榜
        function loadLeaderboard(type) {
            showLoader();
            
            fetch(`${API_BASE_URL}/api/leaderboard`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${authToken}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                hideLoader();
                
                if (data.error) {
                    showModal('加载失败', data.error);
                    return;
                }
                
                // 更新排行榜UI
                const leaderboardList = document.getElementById('leaderboardList');
                leaderboardList.innerHTML = '';
                
                if (data.leaderboard.length === 0) {
                    leaderboardList.innerHTML = '<div style="text-align: center; color: #999; padding: 20px;">暂无排行榜数据</div>';
                    return;
                }
                
                data.leaderboard.forEach((entry, index) => {
                    const leaderboardItem = document.createElement('div');
                    leaderboardItem.className = 'leaderboard-item';
                    
                    // 如果是当前用户，添加特殊样式
                    if (entry.users.id === currentUser.id) {
                        leaderboardItem.classList.add('my-rank');
                    }
                    
                    const leaderboardRank = document.createElement('div');
                    leaderboardRank.className = 'leaderboard-rank';
                    
                    // 前三名特殊样式
                    if (index === 0) {
                        leaderboardRank.classList.add('top1');
                    } else if (index === 1) {
                        leaderboardRank.classList.add('top2');
                    } else if (index === 2) {
                        leaderboardRank.classList.add('top3');
                    }
                    
                    leaderboardRank.textContent = entry.rank;
                    
                    const leaderboardUser = document.createElement('div');
                    leaderboardUser.className = 'leaderboard-user';
                    
                    const leaderboardName = document.createElement('div');
                    leaderboardName.className = 'leaderboard-name';
                    leaderboardName.textContent = entry.users.first_name || '用户';
                    
                    const leaderboardCoins = document.createElement('div');
                    leaderboardCoins.className = 'leaderboard-coins';
                    leaderboardCoins.innerHTML = `<i class="fas fa-coins coins-icon-small"></i> ${entry.flower_coins_earned.toLocaleString()}`;
                    
                    leaderboardUser.appendChild(leaderboardName);
                    leaderboardUser.appendChild(leaderboardCoins);
                    
                    const leaderboardAward = document.createElement('div');
                    leaderboardAward.className = 'leaderboard-award';
                    
                    // 前五名奖励
                    if (index === 0) {
                        leaderboardAward.textContent = '50元';
                    } else if (index === 1) {
                        leaderboardAward.textContent = '30元';
                    } else if (index === 2) {
                        leaderboardAward.textContent = '20元';
                    } else if (index === 3 || index === 4) {
                        leaderboardAward.textContent = '10元';
                    } else {
                        leaderboardAward.style.display = 'none';
                    }
                    
                    leaderboardItem.appendChild(leaderboardRank);
                    leaderboardItem.appendChild(leaderboardUser);
                    leaderboardItem.appendChild(leaderboardAward);
                    
                    leaderboardList.appendChild(leaderboardItem);
                });
                
                // 如果用户不在前100名，显示用户排名
                if (data.user_rank && data.user_rank > 100) {
                    const myRankItem = document.createElement('div');
                    myRankItem.className = 'leaderboard-item my-rank';
                    
                    const myRank = document.createElement('div');
                    myRank.className = 'leaderboard-rank';
                    myRank.textContent = data.user_rank;
                    
                    const myUser = document.createElement('div');
                    myUser.className = 'leaderboard-user';
                    
                    const myName = document.createElement('div');
                    myName.className = 'leaderboard-name';
                    myName.textContent = currentUser.first_name || '我';
                    
                    const myCoins = document.createElement('div');
                    myCoins.className = 'leaderboard-coins';
                    myCoins.innerHTML = `<i class='fas fa-coins coins-icon-small'></i> --`;
                    
                    myUser.appendChild(myName);
                    myUser.appendChild(myCoins);
                    
                    const myAward = document.createElement('div');
                    myAward.className = 'leaderboard-award';
                    myAward.style.display = 'none';
                    
                    myRankItem.appendChild(myRank);
                    myRankItem.appendChild(myUser);
                    myRankItem.appendChild(myAward);
                    
                    leaderboardList.appendChild(myRankItem);
                }
            })
            .catch(error => {
                hideLoader();
                showModal('加载失败', '网络错误，请稍后再试。');
                console.error('Load leaderboard error:', error);
            });
        }
        
        // 绑定排行榜事件
        function bindLeaderboardEvents() {
            // 排行榜标签切换
            const leaderboardTabs = document.querySelectorAll('.leaderboard-tab');
            leaderboardTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // 更新标签状态
                    leaderboardTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 加载对应类型的排行榜
                    const tabType = this.dataset.tab;
                    loadLeaderboard(tabType);
                });
            });
        }
        
        // 绑定游戏事件
        function bindGameEvents() {
            // 道具使用
            const powerupItems = document.querySelectorAll('.powerup-item');
            powerupItems.forEach(item => {
                item.addEventListener('click', function() {
                    const powerupType = this.dataset.powerup;
                    usePowerup(powerupType);
                });
            });
        }
        
        // 使用道具
        function usePowerup(type) {
            // 这里简化处理，实际应用中应该根据道具类型执行不同的操作
            let message = '';
            
            switch (type) {
                case 'refresh':
                    message = '使用刷新道具，重新排列棋盘！';
                    // 重新排列棋盘
                    shuffleBoard();
                    updateBoardUI();
                    break;
                case 'bomb':
                    message = '使用炸弹道具，消除3x3区域！';
                    // 简化处理，实际应该让用户选择位置
                    break;
                case 'rocket':
                    message = '使用火箭道具，消除一行或一列！';
                    // 简化处理，实际应该让用户选择方向
                    break;
                case 'rainbow':
                    message = '使用彩虹球道具，消除所有同色元素！';
                    // 简化处理，实际应该让用户选择颜色
                    break;
            }
            
            showModal('使用道具', message);
        }
        
        // 绑定模态框事件
        function bindModalEvents() {
            // 关闭按钮
            document.getElementById('modalClose').addEventListener('click', closeModal);
            
            // 确定按钮
            document.getElementById('modalButton').addEventListener('click', function() {
                closeModal();
                
                // 如果有回调函数，执行它
                if (this.dataset.callback) {
                    const callback = new Function(this.dataset.callback);
                    callback();
                }
            });
            
            // 点击模态框外部关闭
            document.getElementById('modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
        }
        
        // 显示模态框
        function showModal(title, message, callback, isConfirm = false) {
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalButton = document.getElementById('modalButton');
            
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            
            if (isConfirm) {
                modalButton.textContent = '确认';
                modalButton.style.backgroundColor = '#4CAF50';
            } else {
                modalButton.textContent = '确定';
                modalButton.style.backgroundColor = '';
            }
            
            // 设置回调函数
            if (callback) {
                modalButton.dataset.callback = callback.toString();
            } else {
                delete modalButton.dataset.callback;
            }
            
            modal.style.display = 'flex';
        }
        
        // 关闭模态框
        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }
        
        // 显示加载动画
        function showLoader() {
            document.getElementById('loader').style.display = 'flex';
        }
        
        // 隐藏加载动画
        function hideLoader() {
            document.getElementById('loader').style.display = 'none';
        }
    </script>
</body>
</html>
